{"ast":null,"code":"'use strict';\n/* eslint-env browser */\n\n/**\n * @module HTML\n */\n\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base');\n\nvar utils = require('../utils');\n\nvar Progress = require('../browser/progress');\n\nvar escapeRe = require('escape-string-regexp');\n\nvar constants = require('../runner').constants;\n\nvar EVENT_TEST_PASS = constants.EVENT_TEST_PASS;\nvar EVENT_TEST_FAIL = constants.EVENT_TEST_FAIL;\nvar EVENT_SUITE_BEGIN = constants.EVENT_SUITE_BEGIN;\nvar EVENT_SUITE_END = constants.EVENT_SUITE_END;\nvar EVENT_TEST_PENDING = constants.EVENT_TEST_PENDING;\nvar escape = utils.escape;\n/**\n * Save timer references to avoid Sinon interfering (see GH-237).\n */\n\nvar Date = global.Date;\n/**\n * Expose `HTML`.\n */\n\nexports = module.exports = HTML;\n/**\n * Stats template.\n */\n\nvar statsTemplate = '<ul id=\"mocha-stats\">' + '<li class=\"progress\"><canvas width=\"40\" height=\"40\"></canvas></li>' + '<li class=\"passes\"><a href=\"javascript:void(0);\">passes:</a> <em>0</em></li>' + '<li class=\"failures\"><a href=\"javascript:void(0);\">failures:</a> <em>0</em></li>' + '<li class=\"duration\">duration: <em>0</em>s</li>' + '</ul>';\nvar playIcon = '&#x2023;';\n/**\n * Constructs a new `HTML` reporter instance.\n *\n * @public\n * @class\n * @memberof Mocha.reporters\n * @extends Mocha.reporters.Base\n * @param {Runner} runner - Instance triggers reporter actions.\n * @param {Object} [options] - runner options\n */\n\nfunction HTML(runner, options) {\n  Base.call(this, runner, options);\n  var self = this;\n  var stats = this.stats;\n  var stat = fragment(statsTemplate);\n  var items = stat.getElementsByTagName('li');\n  var passes = items[1].getElementsByTagName('em')[0];\n  var passesLink = items[1].getElementsByTagName('a')[0];\n  var failures = items[2].getElementsByTagName('em')[0];\n  var failuresLink = items[2].getElementsByTagName('a')[0];\n  var duration = items[3].getElementsByTagName('em')[0];\n  var canvas = stat.getElementsByTagName('canvas')[0];\n  var report = fragment('<ul id=\"mocha-report\"></ul>');\n  var stack = [report];\n  var progress;\n  var ctx;\n  var root = document.getElementById('mocha');\n\n  if (canvas.getContext) {\n    var ratio = window.devicePixelRatio || 1;\n    canvas.style.width = canvas.width;\n    canvas.style.height = canvas.height;\n    canvas.width *= ratio;\n    canvas.height *= ratio;\n    ctx = canvas.getContext('2d');\n    ctx.scale(ratio, ratio);\n    progress = new Progress();\n  }\n\n  if (!root) {\n    return error('#mocha div missing, add it to your document');\n  } // pass toggle\n\n\n  on(passesLink, 'click', function (evt) {\n    evt.preventDefault();\n    unhide();\n    var name = /pass/.test(report.className) ? '' : ' pass';\n    report.className = report.className.replace(/fail|pass/g, '') + name;\n\n    if (report.className.trim()) {\n      hideSuitesWithout('test pass');\n    }\n  }); // failure toggle\n\n  on(failuresLink, 'click', function (evt) {\n    evt.preventDefault();\n    unhide();\n    var name = /fail/.test(report.className) ? '' : ' fail';\n    report.className = report.className.replace(/fail|pass/g, '') + name;\n\n    if (report.className.trim()) {\n      hideSuitesWithout('test fail');\n    }\n  });\n  root.appendChild(stat);\n  root.appendChild(report);\n\n  if (progress) {\n    progress.size(40);\n  }\n\n  runner.on(EVENT_SUITE_BEGIN, function (suite) {\n    if (suite.root) {\n      return;\n    } // suite\n\n\n    var url = self.suiteURL(suite);\n    var el = fragment('<li class=\"suite\"><h1><a href=\"%s\">%s</a></h1></li>', url, escape(suite.title)); // container\n\n    stack[0].appendChild(el);\n    stack.unshift(document.createElement('ul'));\n    el.appendChild(stack[0]);\n  });\n  runner.on(EVENT_SUITE_END, function (suite) {\n    if (suite.root) {\n      updateStats();\n      return;\n    }\n\n    stack.shift();\n  });\n  runner.on(EVENT_TEST_PASS, function (test) {\n    var url = self.testURL(test);\n    var markup = '<li class=\"test pass %e\"><h2>%e<span class=\"duration\">%ems</span> ' + '<a href=\"%s\" class=\"replay\">' + playIcon + '</a></h2></li>';\n    var el = fragment(markup, test.speed, test.title, test.duration, url);\n    self.addCodeToggle(el, test.body);\n    appendToStack(el);\n    updateStats();\n  });\n  runner.on(EVENT_TEST_FAIL, function (test) {\n    var el = fragment('<li class=\"test fail\"><h2>%e <a href=\"%e\" class=\"replay\">' + playIcon + '</a></h2></li>', test.title, self.testURL(test));\n    var stackString; // Note: Includes leading newline\n\n    var message = test.err.toString(); // <=IE7 stringifies to [Object Error]. Since it can be overloaded, we\n    // check for the result of the stringifying.\n\n    if (message === '[object Error]') {\n      message = test.err.message;\n    }\n\n    if (test.err.stack) {\n      var indexOfMessage = test.err.stack.indexOf(test.err.message);\n\n      if (indexOfMessage === -1) {\n        stackString = test.err.stack;\n      } else {\n        stackString = test.err.stack.substr(test.err.message.length + indexOfMessage);\n      }\n    } else if (test.err.sourceURL && test.err.line !== undefined) {\n      // Safari doesn't give you a stack. Let's at least provide a source line.\n      stackString = '\\n(' + test.err.sourceURL + ':' + test.err.line + ')';\n    }\n\n    stackString = stackString || '';\n\n    if (test.err.htmlMessage && stackString) {\n      el.appendChild(fragment('<div class=\"html-error\">%s\\n<pre class=\"error\">%e</pre></div>', test.err.htmlMessage, stackString));\n    } else if (test.err.htmlMessage) {\n      el.appendChild(fragment('<div class=\"html-error\">%s</div>', test.err.htmlMessage));\n    } else {\n      el.appendChild(fragment('<pre class=\"error\">%e%e</pre>', message, stackString));\n    }\n\n    self.addCodeToggle(el, test.body);\n    appendToStack(el);\n    updateStats();\n  });\n  runner.on(EVENT_TEST_PENDING, function (test) {\n    var el = fragment('<li class=\"test pass pending\"><h2>%e</h2></li>', test.title);\n    appendToStack(el);\n    updateStats();\n  });\n\n  function appendToStack(el) {\n    // Don't call .appendChild if #mocha-report was already .shift()'ed off the stack.\n    if (stack[0]) {\n      stack[0].appendChild(el);\n    }\n  }\n\n  function updateStats() {\n    // TODO: add to stats\n    var percent = stats.tests / runner.total * 100 | 0;\n\n    if (progress) {\n      progress.update(percent).draw(ctx);\n    } // update stats\n\n\n    var ms = new Date() - stats.start;\n    text(passes, stats.passes);\n    text(failures, stats.failures);\n    text(duration, (ms / 1000).toFixed(2));\n  }\n}\n/**\n * Makes a URL, preserving querystring (\"search\") parameters.\n *\n * @param {string} s\n * @return {string} A new URL.\n */\n\n\nfunction makeUrl(s) {\n  var search = window.location.search; // Remove previous grep query parameter if present\n\n  if (search) {\n    search = search.replace(/[?&]grep=[^&\\s]*/g, '').replace(/^&/, '?');\n  }\n\n  return window.location.pathname + (search ? search + '&' : '?') + 'grep=' + encodeURIComponent(escapeRe(s));\n}\n/**\n * Provide suite URL.\n *\n * @param {Object} [suite]\n */\n\n\nHTML.prototype.suiteURL = function (suite) {\n  return makeUrl(suite.fullTitle());\n};\n/**\n * Provide test URL.\n *\n * @param {Object} [test]\n */\n\n\nHTML.prototype.testURL = function (test) {\n  return makeUrl(test.fullTitle());\n};\n/**\n * Adds code toggle functionality for the provided test's list element.\n *\n * @param {HTMLLIElement} el\n * @param {string} contents\n */\n\n\nHTML.prototype.addCodeToggle = function (el, contents) {\n  var h2 = el.getElementsByTagName('h2')[0];\n  on(h2, 'click', function () {\n    pre.style.display = pre.style.display === 'none' ? 'block' : 'none';\n  });\n  var pre = fragment('<pre><code>%e</code></pre>', utils.clean(contents));\n  el.appendChild(pre);\n  pre.style.display = 'none';\n};\n/**\n * Display error `msg`.\n *\n * @param {string} msg\n */\n\n\nfunction error(msg) {\n  document.body.appendChild(fragment('<div id=\"mocha-error\">%s</div>', msg));\n}\n/**\n * Return a DOM fragment from `html`.\n *\n * @param {string} html\n */\n\n\nfunction fragment(html) {\n  var args = arguments;\n  var div = document.createElement('div');\n  var i = 1;\n  div.innerHTML = html.replace(/%([se])/g, function (_, type) {\n    switch (type) {\n      case 's':\n        return String(args[i++]);\n\n      case 'e':\n        return escape(args[i++]);\n      // no default\n    }\n  });\n  return div.firstChild;\n}\n/**\n * Check for suites that do not have elements\n * with `classname`, and hide them.\n *\n * @param {text} classname\n */\n\n\nfunction hideSuitesWithout(classname) {\n  var suites = document.getElementsByClassName('suite');\n\n  for (var i = 0; i < suites.length; i++) {\n    var els = suites[i].getElementsByClassName(classname);\n\n    if (!els.length) {\n      suites[i].className += ' hidden';\n    }\n  }\n}\n/**\n * Unhide .hidden suites.\n */\n\n\nfunction unhide() {\n  var els = document.getElementsByClassName('suite hidden');\n\n  while (els.length > 0) {\n    els[0].className = els[0].className.replace('suite hidden', 'suite');\n  }\n}\n/**\n * Set an element's text contents.\n *\n * @param {HTMLElement} el\n * @param {string} contents\n */\n\n\nfunction text(el, contents) {\n  if (el.textContent) {\n    el.textContent = contents;\n  } else {\n    el.innerText = contents;\n  }\n}\n/**\n * Listen on `event` with callback `fn`.\n */\n\n\nfunction on(el, event, fn) {\n  if (el.addEventListener) {\n    el.addEventListener(event, fn, false);\n  } else {\n    el.attachEvent('on' + event, fn);\n  }\n}\n\nHTML.browserOnly = true;","map":{"version":3,"sources":["C:/Users/91805/node_modules/mocha/lib/reporters/html.js"],"names":["Base","require","utils","Progress","escapeRe","constants","EVENT_TEST_PASS","EVENT_TEST_FAIL","EVENT_SUITE_BEGIN","EVENT_SUITE_END","EVENT_TEST_PENDING","escape","Date","global","exports","module","HTML","statsTemplate","playIcon","runner","options","call","self","stats","stat","fragment","items","getElementsByTagName","passes","passesLink","failures","failuresLink","duration","canvas","report","stack","progress","ctx","root","document","getElementById","getContext","ratio","window","devicePixelRatio","style","width","height","scale","error","on","evt","preventDefault","unhide","name","test","className","replace","trim","hideSuitesWithout","appendChild","size","suite","url","suiteURL","el","title","unshift","createElement","updateStats","shift","testURL","markup","speed","addCodeToggle","body","appendToStack","stackString","message","err","toString","indexOfMessage","indexOf","substr","length","sourceURL","line","undefined","htmlMessage","percent","tests","total","update","draw","ms","start","text","toFixed","makeUrl","s","search","location","pathname","encodeURIComponent","prototype","fullTitle","contents","h2","pre","display","clean","msg","html","args","arguments","div","i","innerHTML","_","type","String","firstChild","classname","suites","getElementsByClassName","els","textContent","innerText","event","fn","addEventListener","attachEvent","browserOnly"],"mappings":"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","sourcesContent":["'use strict';\n\n/* eslint-env browser */\n/**\n * @module HTML\n */\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base');\nvar utils = require('../utils');\nvar Progress = require('../browser/progress');\nvar escapeRe = require('escape-string-regexp');\nvar constants = require('../runner').constants;\nvar EVENT_TEST_PASS = constants.EVENT_TEST_PASS;\nvar EVENT_TEST_FAIL = constants.EVENT_TEST_FAIL;\nvar EVENT_SUITE_BEGIN = constants.EVENT_SUITE_BEGIN;\nvar EVENT_SUITE_END = constants.EVENT_SUITE_END;\nvar EVENT_TEST_PENDING = constants.EVENT_TEST_PENDING;\nvar escape = utils.escape;\n\n/**\n * Save timer references to avoid Sinon interfering (see GH-237).\n */\n\nvar Date = global.Date;\n\n/**\n * Expose `HTML`.\n */\n\nexports = module.exports = HTML;\n\n/**\n * Stats template.\n */\n\nvar statsTemplate =\n  '<ul id=\"mocha-stats\">' +\n  '<li class=\"progress\"><canvas width=\"40\" height=\"40\"></canvas></li>' +\n  '<li class=\"passes\"><a href=\"javascript:void(0);\">passes:</a> <em>0</em></li>' +\n  '<li class=\"failures\"><a href=\"javascript:void(0);\">failures:</a> <em>0</em></li>' +\n  '<li class=\"duration\">duration: <em>0</em>s</li>' +\n  '</ul>';\n\nvar playIcon = '&#x2023;';\n\n/**\n * Constructs a new `HTML` reporter instance.\n *\n * @public\n * @class\n * @memberof Mocha.reporters\n * @extends Mocha.reporters.Base\n * @param {Runner} runner - Instance triggers reporter actions.\n * @param {Object} [options] - runner options\n */\nfunction HTML(runner, options) {\n  Base.call(this, runner, options);\n\n  var self = this;\n  var stats = this.stats;\n  var stat = fragment(statsTemplate);\n  var items = stat.getElementsByTagName('li');\n  var passes = items[1].getElementsByTagName('em')[0];\n  var passesLink = items[1].getElementsByTagName('a')[0];\n  var failures = items[2].getElementsByTagName('em')[0];\n  var failuresLink = items[2].getElementsByTagName('a')[0];\n  var duration = items[3].getElementsByTagName('em')[0];\n  var canvas = stat.getElementsByTagName('canvas')[0];\n  var report = fragment('<ul id=\"mocha-report\"></ul>');\n  var stack = [report];\n  var progress;\n  var ctx;\n  var root = document.getElementById('mocha');\n\n  if (canvas.getContext) {\n    var ratio = window.devicePixelRatio || 1;\n    canvas.style.width = canvas.width;\n    canvas.style.height = canvas.height;\n    canvas.width *= ratio;\n    canvas.height *= ratio;\n    ctx = canvas.getContext('2d');\n    ctx.scale(ratio, ratio);\n    progress = new Progress();\n  }\n\n  if (!root) {\n    return error('#mocha div missing, add it to your document');\n  }\n\n  // pass toggle\n  on(passesLink, 'click', function (evt) {\n    evt.preventDefault();\n    unhide();\n    var name = /pass/.test(report.className) ? '' : ' pass';\n    report.className = report.className.replace(/fail|pass/g, '') + name;\n    if (report.className.trim()) {\n      hideSuitesWithout('test pass');\n    }\n  });\n\n  // failure toggle\n  on(failuresLink, 'click', function (evt) {\n    evt.preventDefault();\n    unhide();\n    var name = /fail/.test(report.className) ? '' : ' fail';\n    report.className = report.className.replace(/fail|pass/g, '') + name;\n    if (report.className.trim()) {\n      hideSuitesWithout('test fail');\n    }\n  });\n\n  root.appendChild(stat);\n  root.appendChild(report);\n\n  if (progress) {\n    progress.size(40);\n  }\n\n  runner.on(EVENT_SUITE_BEGIN, function (suite) {\n    if (suite.root) {\n      return;\n    }\n\n    // suite\n    var url = self.suiteURL(suite);\n    var el = fragment(\n      '<li class=\"suite\"><h1><a href=\"%s\">%s</a></h1></li>',\n      url,\n      escape(suite.title)\n    );\n\n    // container\n    stack[0].appendChild(el);\n    stack.unshift(document.createElement('ul'));\n    el.appendChild(stack[0]);\n  });\n\n  runner.on(EVENT_SUITE_END, function (suite) {\n    if (suite.root) {\n      updateStats();\n      return;\n    }\n    stack.shift();\n  });\n\n  runner.on(EVENT_TEST_PASS, function (test) {\n    var url = self.testURL(test);\n    var markup =\n      '<li class=\"test pass %e\"><h2>%e<span class=\"duration\">%ems</span> ' +\n      '<a href=\"%s\" class=\"replay\">' +\n      playIcon +\n      '</a></h2></li>';\n    var el = fragment(markup, test.speed, test.title, test.duration, url);\n    self.addCodeToggle(el, test.body);\n    appendToStack(el);\n    updateStats();\n  });\n\n  runner.on(EVENT_TEST_FAIL, function (test) {\n    var el = fragment(\n      '<li class=\"test fail\"><h2>%e <a href=\"%e\" class=\"replay\">' +\n        playIcon +\n        '</a></h2></li>',\n      test.title,\n      self.testURL(test)\n    );\n    var stackString; // Note: Includes leading newline\n    var message = test.err.toString();\n\n    // <=IE7 stringifies to [Object Error]. Since it can be overloaded, we\n    // check for the result of the stringifying.\n    if (message === '[object Error]') {\n      message = test.err.message;\n    }\n\n    if (test.err.stack) {\n      var indexOfMessage = test.err.stack.indexOf(test.err.message);\n      if (indexOfMessage === -1) {\n        stackString = test.err.stack;\n      } else {\n        stackString = test.err.stack.substr(\n          test.err.message.length + indexOfMessage\n        );\n      }\n    } else if (test.err.sourceURL && test.err.line !== undefined) {\n      // Safari doesn't give you a stack. Let's at least provide a source line.\n      stackString = '\\n(' + test.err.sourceURL + ':' + test.err.line + ')';\n    }\n\n    stackString = stackString || '';\n\n    if (test.err.htmlMessage && stackString) {\n      el.appendChild(\n        fragment(\n          '<div class=\"html-error\">%s\\n<pre class=\"error\">%e</pre></div>',\n          test.err.htmlMessage,\n          stackString\n        )\n      );\n    } else if (test.err.htmlMessage) {\n      el.appendChild(\n        fragment('<div class=\"html-error\">%s</div>', test.err.htmlMessage)\n      );\n    } else {\n      el.appendChild(\n        fragment('<pre class=\"error\">%e%e</pre>', message, stackString)\n      );\n    }\n\n    self.addCodeToggle(el, test.body);\n    appendToStack(el);\n    updateStats();\n  });\n\n  runner.on(EVENT_TEST_PENDING, function (test) {\n    var el = fragment(\n      '<li class=\"test pass pending\"><h2>%e</h2></li>',\n      test.title\n    );\n    appendToStack(el);\n    updateStats();\n  });\n\n  function appendToStack(el) {\n    // Don't call .appendChild if #mocha-report was already .shift()'ed off the stack.\n    if (stack[0]) {\n      stack[0].appendChild(el);\n    }\n  }\n\n  function updateStats() {\n    // TODO: add to stats\n    var percent = ((stats.tests / runner.total) * 100) | 0;\n    if (progress) {\n      progress.update(percent).draw(ctx);\n    }\n\n    // update stats\n    var ms = new Date() - stats.start;\n    text(passes, stats.passes);\n    text(failures, stats.failures);\n    text(duration, (ms / 1000).toFixed(2));\n  }\n}\n\n/**\n * Makes a URL, preserving querystring (\"search\") parameters.\n *\n * @param {string} s\n * @return {string} A new URL.\n */\nfunction makeUrl(s) {\n  var search = window.location.search;\n\n  // Remove previous grep query parameter if present\n  if (search) {\n    search = search.replace(/[?&]grep=[^&\\s]*/g, '').replace(/^&/, '?');\n  }\n\n  return (\n    window.location.pathname +\n    (search ? search + '&' : '?') +\n    'grep=' +\n    encodeURIComponent(escapeRe(s))\n  );\n}\n\n/**\n * Provide suite URL.\n *\n * @param {Object} [suite]\n */\nHTML.prototype.suiteURL = function (suite) {\n  return makeUrl(suite.fullTitle());\n};\n\n/**\n * Provide test URL.\n *\n * @param {Object} [test]\n */\nHTML.prototype.testURL = function (test) {\n  return makeUrl(test.fullTitle());\n};\n\n/**\n * Adds code toggle functionality for the provided test's list element.\n *\n * @param {HTMLLIElement} el\n * @param {string} contents\n */\nHTML.prototype.addCodeToggle = function (el, contents) {\n  var h2 = el.getElementsByTagName('h2')[0];\n\n  on(h2, 'click', function () {\n    pre.style.display = pre.style.display === 'none' ? 'block' : 'none';\n  });\n\n  var pre = fragment('<pre><code>%e</code></pre>', utils.clean(contents));\n  el.appendChild(pre);\n  pre.style.display = 'none';\n};\n\n/**\n * Display error `msg`.\n *\n * @param {string} msg\n */\nfunction error(msg) {\n  document.body.appendChild(fragment('<div id=\"mocha-error\">%s</div>', msg));\n}\n\n/**\n * Return a DOM fragment from `html`.\n *\n * @param {string} html\n */\nfunction fragment(html) {\n  var args = arguments;\n  var div = document.createElement('div');\n  var i = 1;\n\n  div.innerHTML = html.replace(/%([se])/g, function (_, type) {\n    switch (type) {\n      case 's':\n        return String(args[i++]);\n      case 'e':\n        return escape(args[i++]);\n      // no default\n    }\n  });\n\n  return div.firstChild;\n}\n\n/**\n * Check for suites that do not have elements\n * with `classname`, and hide them.\n *\n * @param {text} classname\n */\nfunction hideSuitesWithout(classname) {\n  var suites = document.getElementsByClassName('suite');\n  for (var i = 0; i < suites.length; i++) {\n    var els = suites[i].getElementsByClassName(classname);\n    if (!els.length) {\n      suites[i].className += ' hidden';\n    }\n  }\n}\n\n/**\n * Unhide .hidden suites.\n */\nfunction unhide() {\n  var els = document.getElementsByClassName('suite hidden');\n  while (els.length > 0) {\n    els[0].className = els[0].className.replace('suite hidden', 'suite');\n  }\n}\n\n/**\n * Set an element's text contents.\n *\n * @param {HTMLElement} el\n * @param {string} contents\n */\nfunction text(el, contents) {\n  if (el.textContent) {\n    el.textContent = contents;\n  } else {\n    el.innerText = contents;\n  }\n}\n\n/**\n * Listen on `event` with callback `fn`.\n */\nfunction on(el, event, fn) {\n  if (el.addEventListener) {\n    el.addEventListener(event, fn, false);\n  } else {\n    el.attachEvent('on' + event, fn);\n  }\n}\n\nHTML.browserOnly = true;\n"]},"metadata":{},"sourceType":"script"}